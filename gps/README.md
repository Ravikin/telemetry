Credits: some code thanks to http://toptechboy.com
